---
import type { GalleryPhoto } from "@/features/gallery/types";

export interface Props {
  photo: GalleryPhoto;
  index: number;
  galleryId: string;
}

const { photo, index, galleryId } = Astro.props as Props;

const alt = photo.title?.trim() ? photo.title : "Photograph";
const aspectRatio = `${photo.width} / ${photo.height}`;
---

<button
  type="button"
  class="group block w-full mb-4 text-left rounded-xl"
  data-gallery-id={galleryId}
  data-gallery-index={String(index)}
  aria-label={`Open photo: ${alt}`}
>
  <div
    class="relative overflow-hidden rounded-xl"
    style={`aspect-ratio: ${aspectRatio};`}
  >
    <img
      src={photo.thumbSrc}
      width={photo.thumbWidth}
      height={photo.thumbHeight}
      loading="lazy"
      decoding="async"
      alt={alt}
      class="absolute inset-0 w-full h-full object-cover grayscale transition-[filter,transform] duration-300 ease-out group-hover:grayscale-0"
    />
    <div class="absolute inset-0 bg-gradient-to-t from-black/30 via-black/0 to-black/0 opacity-0 group-hover:opacity-100 transition-opacity duration-200" />
    {photo.title?.trim() && (
      <div class="absolute inset-x-0 bottom-0 px-3 pb-2 pt-6 text-xs text-white/85 opacity-0 translate-y-1 group-hover:opacity-70 group-hover:translate-y-0 transition-all duration-200">
        {photo.title}
      </div>
    )}
  </div>

</button>

